---
/* src/layouts/Layout.astro */
const { title = 'A.R.A.I.' } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    <link rel="stylesheet" href="/styles/global.css" />
    <style>
      :root {
        --blue: #003366;
        --blue-2: #004080;
        --blue-3: #0b3a6a;
        --text-on-blue: #fff;
      }

      body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

      header nav {
        background-color: var(--blue);
        padding: 0.75rem 1rem;
      }

      .nav-container {
        display: flex; align-items: center; justify-content: space-between;
        max-width: 1200px; margin: 0 auto;
      }

      .brand { color: var(--text-on-blue); font-weight: 800; letter-spacing: .5px; }

      /* Primary links row (desktop) */
      .nav-links {
        display: flex; gap: .25rem; align-items: center; flex-wrap: wrap;
      }

      .nav-link, .submenu a {
        color: var(--text-on-blue); text-decoration: none; font-weight: 500;
        padding: .5rem .6rem; border-radius: .25rem;
      }
      .nav-link:hover { background: rgba(255,255,255,.08); }

      /* Dropdown groups */
      .nav-item { position: relative; display: flex; align-items: center; }
      .submenu-toggle {
        background: transparent; border: 0; color: var(--text-on-blue);
        padding: .25rem .35rem; cursor: pointer; font-size: 1rem; line-height: 1;
      }

      .submenu {
        position: absolute; top: 100%; left: 0; min-width: 240px;
        background: var(--blue-3); border: 1px solid rgba(255,255,255,.15);
        display: none; flex-direction: column; padding: .25rem 0; z-index: 50;
      }
      .submenu a { display: block; padding: .55rem .75rem; }
      .submenu a:hover { background: rgba(255,255,255,.08); }

      /* Desktop: open on hover */
      @media (hover:hover) {
        .has-submenu:hover .submenu { display: flex; }
      }
      /* Mobile: open with JS class */
      .has-submenu.open .submenu { display: flex; }

      /* Hamburger + mobile panel */
      .hamburger {
        display: none; flex-direction: column; gap: 4px; cursor: pointer;
        margin-left: .5rem;
      }
      .hamburger span { width: 26px; height: 3px; background: var(--text-on-blue); }

      .mobile-panel {
        display: none; flex-direction: column; gap: .25rem; padding: .5rem 0;
        border-top: 1px solid rgba(255,255,255,.15);
      }
      .mobile-panel .group { padding: .25rem 0; }
      .mobile-panel .group-title {
        color: var(--text-on-blue); font-weight: 700; padding: .5rem .25rem .25rem;
        opacity: .85;
      }
      .mobile-link { color: var(--text-on-blue); text-decoration: none; display: block; padding: .5rem .25rem; }
      .mobile-submenu { margin-left: .5rem; display: none; }
      .mobile-submenu.open { display: block; }
      .mobile-subtoggle {
        background: transparent; border: 0; color: var(--text-on-blue); cursor: pointer; padding: .25rem .35rem;
      }

      /* Responsive */
      @media (max-width: 820px) {
        .nav-links { display: none; }
        .hamburger { display: flex; }
        .mobile-panel.active { display: flex; }
      }

      main { max-width: 1200px; margin: 1.25rem auto; padding: 0 1rem; }

      footer { max-width: 1200px; margin: 2rem auto 3rem; padding: 0 1rem; color: #333; }
      .site-disclaimer {
        font-size: 0.9rem; color: #555; background: #f9f9f9; border-top: 1px solid #ddd;
        padding: 1rem 1.25rem; margin-top: 1.25rem; line-height: 1.55;
      }
    </style>
  </head>

  <body>
    <header>
      <nav>
        <div class="nav-container">
          <div class="brand">A.R.A.I.</div>

          <!-- Desktop links -->
          <div class="nav-links" role="menubar" aria-label="Primary">
            <a class="nav-link" href="/">Home</a>
            <a class="nav-link" href="/about/">About</a>

            <!-- Research (dropdown) -->
            <div class="nav-item has-submenu">
              <a class="nav-link" href="/research/natural-immune-system-support/">Research</a>
              <button class="submenu-toggle" aria-expanded="false" aria-controls="sub-research" aria-label="Toggle Research menu">▾</button>
              <div id="sub-research" class="submenu" role="menu" aria-label="Research submenu">
             <!-- Research dropdown items -->
<li><a href="/research/natural-immune-system-support">Natural Immune System Support</a></li>
<li><a href="/research/cancer-research">Cancer Research</a></li>
<li><a href="/research/essential-oil-research">Essential Oil Research</a></li>
<li><a href="/research/detoxification-research">Detoxification Research</a></li>
<li><a href="/research/enzyme-research">Enzyme Research</a></li>
<li><a href="/research/autoimmune-research">Autoimmune Research</a></li>
<li><a href="/research/zeolite-research">Zeolite Research</a></li>
<li><a href="/research/vaccine-detox-research">Vaccine Detox Research</a></li>
<li><a href="/research/science-of-flax-hull-lignans">HIV/AIDS Research</a></li>
<li><a href="/research/longevity-research">Longevity Research</a></li>

              </div>
            </div>

            <a class="nav-link" href="/protocols/">Protocols</a>

            <!-- Health Help (clickable parent + dropdown) -->
            <div class="nav-item has-submenu">
              <a class="nav-link" href="/health-help/">Health Help</a>
              <button class="submenu-toggle" aria-expanded="false" aria-controls="sub-health" aria-label="Toggle Health Help menu">▾</button>
              <div id="sub-health" class="submenu" role="menu" aria-label="Health Help submenu">
                <a href="/health-help/financial-help/">Financial Help</a>
                <a href="/health-help/recommended-physicians/">Physician Help</a>
              </div>
            </div>

            <a class="nav-link" href="/testimonials/">Testimonials</a>
            <a class="nav-link" href="/thirdworld/">3rd World Help</a>
            <a class="nav-link" href="/contact/">Contact</a>
          </div>

          <!-- Hamburger -->
          <div class="hamburger" id="hamburger" aria-label="Toggle menu" aria-expanded="false">
            <span></span><span></span><span></span>
          </div>
        </div>

        <!-- Mobile panel -->
        <div class="mobile-panel" id="mobilePanel">
          <div class="group">
            <a class="mobile-link" href="/">Home</a>
            <a class="mobile-link" href="/about/">About</a>
          </div>

          <div class="group">
            <div class="group-title">
              Research
              <button class="mobile-subtoggle" data-target="#m-sub-research" aria-expanded="false">▾</button>
            </div>
            <div class="mobile-submenu" id="m-sub-research">
              <a class="mobile-link" href="/research/natural-immune-system-support/">Natural Immune System Support</a>
<a class="mobile-link" href="/research/science-of-flax-hull-lignans/">Science of Flax Hull Lignans</a>
<a class="mobile-link" href="/research/vaccine-detox-research/">Vaccine Detox Research</a>
<a class="mobile-link" href="/research/zeolite-research/">Zeolite Science</a>
<a class="mobile-link" href="/research/essential-oil-research/">Essential Oil Research</a>
<a class="mobile-link" href="/research/enzyme-research/">Enzyme Research</a>
<a class="mobile-link" href="/research/longevity-research/">Longevity Research</a>
<a class="mobile-link" href="/research/cancer-research/">Cancer Research</a>
<a class="mobile-link" href="/research/detoxification-research/">Detoxification Research</a>
<a class="mobile-link" href="/research/autoimmune-research/">Autoimmune Research</a>

            </div>
          </div>

          <div class="group">
            <a class="mobile-link" href="/protocols/">Protocols</a>
          </div>

          <div class="group">
            <div class="group-title">
              Health Help
              <button class="mobile-subtoggle" data-target="#m-sub-health" aria-expanded="false">▾</button>
            </div>
            <div class="mobile-submenu" id="m-sub-health">
              <a class="mobile-link" href="/health-help/">Overview</a>
              <a class="mobile-link" href="/health-help/financial-help/">Financial Help</a>
              <a class="mobile-link" href="/health-help/recommended-physicians/">Physician Help</a>
            </div>
          </div>

          <div class="group">
            <a class="mobile-link" href="/testimonials/">Testimonials</a>
            <a class="mobile-link" href="/thirdworld/">3rd World Help</a>
            <a class="mobile-link" href="/contact/">Contact</a>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <slot />
    </main>

    <footer>
      <hr />
      <p style="text-align:center;">© {new Date().getFullYear()} A.R.A.I.</p>
      <div class="site-disclaimer">
        <p><strong>Disclaimer:</strong> This website is operated by a non-profit organization and is for educational and informational purposes only. We are not physicians, and the information provided here is not intended as medical advice, diagnosis, or treatment. Nothing on this site should be construed as a substitute for professional medical guidance. We encourage you to share any research, protocols, or information found here with your qualified healthcare provider to determine how it may or may not apply to your personal situation. Everyone’s health circumstances are unique — always consult your own physician or other qualified healthcare professional regarding any medical questions or concerns. By using this site, you agree that you do so at your own discretion and risk.</p>
      </div>
    </footer>

    <script>
      // Mobile menu toggle
      const hamburger = document.getElementById('hamburger');
      const mobilePanel = document.getElementById('mobilePanel');
      hamburger?.addEventListener('click', () => {
        const open = mobilePanel.classList.toggle('active');
        hamburger.setAttribute('aria-expanded', String(open));
        // Close any open mobile submenus when panel closes
        if (!open) {
          document.querySelectorAll('.mobile-submenu').forEach(s => s.classList.remove('open'));
          document.querySelectorAll('.mobile-subtoggle').forEach(b => b.setAttribute('aria-expanded', 'false'));
        }
      });

      // Desktop submenu toggle (click support, in addition to hover)
      document.addEventListener('click', (e) => {
        const btn = e.target.closest('.submenu-toggle');
        const items = document.querySelectorAll('.has-submenu');
        if (!btn) {
          // click outside dropdowns => close all
          items.forEach(i => i.classList.remove('open'));
          document.querySelectorAll('.submenu-toggle').forEach(b => b.setAttribute('aria-expanded', 'false'));
          return;
        }
        const item = btn.closest('.has-submenu');
        const isOpen = item.classList.contains('open');
        items.forEach(i => i.classList.remove('open'));
        document.querySelectorAll('.submenu-toggle').forEach(b => b.setAttribute('aria-expanded', 'false'));
        item.classList.toggle('open', !isOpen);
        btn.setAttribute('aria-expanded', String(!isOpen));
      });

      // Mobile submenus
      document.querySelectorAll('.mobile-subtoggle').forEach(btn => {
        btn.addEventListener('click', () => {
          const targetSel = btn.getAttribute('data-target');
          const target = document.querySelector(targetSel);
          const willOpen = !target.classList.contains('open');
          // close siblings
          const group = btn.closest('.group');
          group.querySelectorAll('.mobile-submenu').forEach(s => s.classList.remove('open'));
          group.querySelectorAll('.mobile-subtoggle').forEach(b => b.setAttribute('aria-expanded', 'false'));
          // open current
          target.classList.toggle('open', willOpen);
          btn.setAttribute('aria-expanded', String(willOpen));
        });
      });
    </script>
  </body>
</html>
